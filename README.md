FC2BLOG image-file relocatation utility
====

## 概要
・ブログの画像ファイルを古いディレクトリから新たなディレクトリに再配置する。

### より詳しく言うと
・extrct_comment.py （別プロジェクト）で生成した fc2.db （データベース・ファイル）に基いて img（ディレクトリ）に分類格納された画像ファイルを再配置する。

## 背景
・ブログ記事中にリンクされている画像ファイルは img ディレクトリに格納されている。  
・なお、画像は多数あり、全体では xx MB 以上にもなっている。それゆえ、img ディレクトリの直下にばらまくのではなく、サブディレクトリごとに小分けしている。

・その小分けの方法は、従来は blog記事の作成年月で決め打ちしていた（例："2018-12"）。  
・だが、blog 記事の作成年月で格納ディレクトリを決めより、url-no で決めたほうがわかりやすく、ロジックも明確になることに気づいた。

・なぜなら…  
 　　・url-no は一義的だが、記事の作成年月の解釈は一義的ではない。  
 　　・記事の作成年月は FC2 blog のシステム依存な面がある。  
 　　・記事の末尾に記載している日付は大概、実際の日付とは一致しない。  

・そこで img ディレクトリに格納済みの大量の画像ファイルを配置し直すことに決めた。

・つまり、従来は  
　　img/2018-12/a.jpg  
　というように小分けしていたが、  
　　img/00128/a.jpg  
　に移動させる。なお、00128 は a.jpg を参照している blog 記事の url_no / 100 に相当。

## 処理の概要
1. fc2.db（データベースファイル）を開き、記事を url_no でソートして順に読み出す。
2. 記事の本文 body_untaged ? を beautifulSoup で解析し、href... <img ...> タグに含まれる画像ファイルを list にリストアップ。
3. 同時に、記事の作成日時 date_create ? から従来の格納先ディレクトリ(old_img_dir)を得る。
4. url_no から新しい格納先ディレクトリ（new_img_dir）を求める。
5. リストアップした画像ファイルを old_img_dir から new_img_dir に移動させる。

## 対象
 python3

## 実行方法
  python img_relocate.py -h

### 実行の具体例
  python img_relocate.py check -func_test 2

## 入力ファイル
  1. blog_url.text （ファイル名固定）
  2. fc2.db （ファイル名固定）

### 入力ファイルの置き場所
　・img_relocate.py と同じディレクトリ

## blog_url.text の内容の例
  ・ (XXXX は該当する blog の id に相当 )

```
http://XXXX.blog.fc2.com
https://XXXX.blog.fc2.com
```
## 履歴
2019-02-17 更新
2018-12-18 作成

## 現況
### 2019-02-17 テスト中
